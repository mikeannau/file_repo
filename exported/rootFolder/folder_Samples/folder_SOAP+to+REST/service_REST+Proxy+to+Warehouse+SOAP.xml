<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="f6dba503de22010ed690df32359fcb6f" version="2">
    <l7:ServiceDetail folderId="697655b6deecb226df6ffad71ee4776a" id="f6dba503de22010ed690df32359fcb6f" version="2">
        <l7:Name>REST Proxy to Warehouse SOAP</l7:Name>
        <l7:Enabled>true</l7:Enabled>
        <l7:ServiceMappings>
            <l7:HttpMapping>
                <l7:UrlPattern>/warehouse_rest*</l7:UrlPattern>
                <l7:Verbs>
                    <l7:Verb>GET</l7:Verb>
                    <l7:Verb>POST</l7:Verb>
                    <l7:Verb>PUT</l7:Verb>
                    <l7:Verb>DELETE</l7:Verb>
                </l7:Verbs>
            </l7:HttpMapping>
        </l7:ServiceMappings>
        <l7:Properties>
            <l7:Property key="internal">
                <l7:BooleanValue>false</l7:BooleanValue>
            </l7:Property>
            <l7:Property key="policyRevision">
                <l7:LongValue>35</l7:LongValue>
            </l7:Property>
            <l7:Property key="soap">
                <l7:BooleanValue>false</l7:BooleanValue>
            </l7:Property>
            <l7:Property key="tracingEnabled">
                <l7:BooleanValue>false</l7:BooleanValue>
            </l7:Property>
            <l7:Property key="wssProcessingEnabled">
                <l7:BooleanValue>false</l7:BooleanValue>
            </l7:Property>
        </l7:Properties>
    </l7:ServiceDetail>
    <l7:Resources>
        <l7:ResourceSet tag="policy">
            <l7:Resource type="policy" version="34">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="#######################################################"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="REST PROXY POLICY BLUEPRINT"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="#######################################################"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.url.path}/"/&gt;
                    &lt;L7p:Expression2 stringValue="/orders/"/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="CONTAINS"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Operator operator="CONTAINS"/&gt;
                            &lt;L7p:RightValue stringValue="/orders/"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="GET"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="GET"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cDovL3dhcmVob3VzZS5hY21lLmNvbS93cy9jdXJyZW50T3JkZXJz"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapAction"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5wYXRofQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="accountId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaseInsensitive booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="accountId"/&gt;
                    &lt;L7p:Regex stringValue="/warehouse_rest/orders/"/&gt;
                    &lt;L7p:RegexName stringValue="Retrieve Account ID from URL"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOndzPSJodHRwOi8vd2FyZWhvdXNlLmFjbWUuY29tL3dzIj4NCiAgIDxzb2FwZW52OkhlYWRlci8+DQogICA8c29hcGVudjpCb2R5Pg0KICAgICAgPHdzOmN1cnJlbnRPcmRlcnM+DQogICAgICAgICA8d3M6YWNjb3VudGlkPiR7YWNjb3VudElkfTwvd3M6YWNjb3VudGlkPg0KICAgICAgICAgPHdzOmRlbGF5PjE8L3dzOmRlbGF5Pg0KICAgICAgPC93czpjdXJyZW50T3JkZXJzPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapContent"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="http://ssg:8080/ACMEWarehouse/services/WarehouseSoap"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Cookie"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:CustomizeValue stringValue="&amp;quot;${soapAction}&amp;quot;"/&gt;
                                &lt;L7p:Name stringValue="SOAPAction"/&gt;
                                &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="soapContent"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:ForwardAll booleanValue="true"/&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                        &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:output indent="yes" method="xml" /&gt;
  &lt;xsl:strip-space elements="*" /&gt;
  &lt;xsl:template match="*[(local-name()='Envelope' or local-name()='Body') and (namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/' or namespace-uri()='http://www.w3.org/2003/05/soap-envelope')]"&gt;
    &lt;xsl:apply-templates select="@*|node()" /&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="*"&gt;
    &lt;xsl:element name="{local-name()}"&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:element&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="@*|node()" priority="-2"&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;L7p:XsltVersion stringValue="1.0"/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget="included"&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                        &lt;L7p:Target target="OTHER"/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue="true"/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:RootTagString stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Transforming the /currentOrders operation"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.url.path}/"/&gt;
                    &lt;L7p:Expression2 stringValue="/ProductDetails/"/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="CONTAINS"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Operator operator="CONTAINS"/&gt;
                            &lt;L7p:RightValue stringValue="/ProductDetails/"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="GET"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="GET"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5wYXRofQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="productId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaseInsensitive booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="productId"/&gt;
                    &lt;L7p:Regex stringValue="/warehouse_rest/productdetails/"/&gt;
                    &lt;L7p:RegexName stringValue="Retrieve Product ID from URL"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOndzPSJodHRwOi8vd2FyZWhvdXNlLmFjbWUuY29tL3dzIj4NCiAgIDxzb2FwZW52OkhlYWRlci8+DQogICA8c29hcGVudjpCb2R5Pg0KICAgICAgPHdzOmdldFByb2R1Y3REZXRhaWxzPg0KICAgICAgICAgPHdzOnByb2R1Y3RpZD4ke3Byb2R1Y3RJZH08L3dzOnByb2R1Y3RpZD4NCiAgICAgICAgIDx3czpkZWxheT4xPC93czpkZWxheT4NCiAgICAgIDwvd3M6Z2V0UHJvZHVjdERldGFpbHM+DQogICA8L3NvYXBlbnY6Qm9keT4NCjwvc29hcGVudjpFbnZlbG9wZT4="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapContent"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cDovL3dhcmVob3VzZS5hY21lLmNvbS93cy9nZXRQcm9kdWN0RGV0YWlscw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="soapAction"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="http://ssg:8080/ACMEWarehouse/services/WarehouseSoap"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Cookie"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:CustomizeValue stringValue="&amp;quot;${soapAction}&amp;quot;"/&gt;
                                &lt;L7p:Name stringValue="SOAPAction"/&gt;
                                &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="soapContent"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:ForwardAll booleanValue="true"/&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                        &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:output indent="yes" method="xml" /&gt;
  &lt;xsl:strip-space elements="*" /&gt;
  &lt;xsl:template match="*[(local-name()='Envelope' or local-name()='Body') and (namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/' or namespace-uri()='http://www.w3.org/2003/05/soap-envelope')]"&gt;
    &lt;xsl:apply-templates select="@*|node()" /&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="*"&gt;
    &lt;xsl:element name="{local-name()}"&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:element&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="@*|node()" priority="-2"&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;L7p:XsltVersion stringValue="1.0"/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget="included"&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                        &lt;L7p:Target target="OTHER"/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue="true"/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:RootTagString stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Transforming the /getProductDetails operation"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.url.path}/"/&gt;
                    &lt;L7p:Expression2 stringValue="/products/"/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="CONTAINS"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Operator operator="CONTAINS"/&gt;
                            &lt;L7p:RightValue stringValue="/products/"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="GET"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="GET"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOndzPSJodHRwOi8vd2FyZWhvdXNlLmFjbWUuY29tL3dzIj4NCiAgIDxzb2FwZW52OkhlYWRlci8+DQogICA8c29hcGVudjpCb2R5Pg0KICAgICAgPHdzOmxpc3RQcm9kdWN0cz4NCiAgICAgICAgIDx3czpkZWxheT4wPC93czpkZWxheT4NCiAgICAgIDwvd3M6bGlzdFByb2R1Y3RzPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapContent"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cDovL3dhcmVob3VzZS5hY21lLmNvbS93cy9saXN0UHJvZHVjdHM="/&gt;
                    &lt;L7p:VariableToSet stringValue="soapAction"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValue="SOAP Error in REST terms"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"/&gt;
                    &lt;L7p:HttpStatus stringValue="409"/&gt;
                &lt;/L7p:CustomizeErrorResponse&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="http://ssg:8080/ACMEWarehouse/services/WarehouseSoap"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Cookie"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:CustomizeValue stringValue="&amp;quot;${soapAction}&amp;quot;"/&gt;
                                &lt;L7p:Name stringValue="SOAPAction"/&gt;
                                &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="soapContent"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:ForwardAll booleanValue="true"/&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                        &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:output indent="yes" method="xml" /&gt;
  &lt;xsl:strip-space elements="*" /&gt;
  &lt;xsl:template match="*[(local-name()='Envelope' or local-name()='Body') and (namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/' or namespace-uri()='http://www.w3.org/2003/05/soap-envelope')]"&gt;
    &lt;xsl:apply-templates select="@*|node()" /&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="*"&gt;
    &lt;xsl:element name="{local-name()}"&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:element&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="@*|node()" priority="-2"&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;L7p:XsltVersion stringValue="1.0"/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget="included"&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                        &lt;L7p:Target target="OTHER"/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue="true"/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:RootTagString stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Transforming the /listProucts operation"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.url.path}/"/&gt;
                    &lt;L7p:Expression2 stringValue="/placeOrder"/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="CONTAINS"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Operator operator="CONTAINS"/&gt;
                            &lt;L7p:RightValue stringValue="/placeOrder"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="POST"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="POST"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:EvaluateJsonPathExpression&gt;
                    &lt;L7p:Expression stringValue=".productid"/&gt;
                    &lt;L7p:VariablePrefix stringValue="productId"/&gt;
                &lt;/L7p:EvaluateJsonPathExpression&gt;
                &lt;L7p:EvaluateJsonPathExpression&gt;
                    &lt;L7p:Expression stringValue=".amount"/&gt;
                    &lt;L7p:VariablePrefix stringValue="amount"/&gt;
                &lt;/L7p:EvaluateJsonPathExpression&gt;
                &lt;L7p:EvaluateJsonPathExpression&gt;
                    &lt;L7p:Expression stringValue=".price"/&gt;
                    &lt;L7p:VariablePrefix stringValue="price"/&gt;
                &lt;/L7p:EvaluateJsonPathExpression&gt;
                &lt;L7p:EvaluateJsonPathExpression&gt;
                    &lt;L7p:Expression stringValue=".accountid"/&gt;
                    &lt;L7p:VariablePrefix stringValue="accountid"/&gt;
                &lt;/L7p:EvaluateJsonPathExpression&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOndzPSJodHRwOi8vd2FyZWhvdXNlLmFjbWUuY29tL3dzIj4NCiAgIDxzb2FwZW52OkhlYWRlci8+DQogICA8c29hcGVudjpCb2R5Pg0KICAgICAgPHdzOnBsYWNlT3JkZXI+DQogICAgICAgICA8d3M6cHJvZHVjdGlkPiR7cHJvZHVjdGlkLnJlc3VsdH08L3dzOnByb2R1Y3RpZD4NCiAgICAgICAgIDx3czphbW91bnQ+JHthbW91bnQucmVzdWx0fTwvd3M6YW1vdW50Pg0KICAgICAgICAgPHdzOnByaWNlPiR7cHJpY2UucmVzdWx0fTwvd3M6cHJpY2U+DQogICAgICAgICA8d3M6YWNjb3VudGlkPiR7YWNjb3VudElkLnJlc3VsdH08L3dzOmFjY291bnRpZD4NCiAgICAgICAgIDx3czpkZWxheT4xPC93czpkZWxheT4NCiAgICAgIDwvd3M6cGxhY2VPcmRlcj4NCiAgIDwvc29hcGVudjpCb2R5Pg0KPC9zb2FwZW52OkVudmVsb3BlPg=="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapContent"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cDovL3dhcmVob3VzZS5hY21lLmNvbS93cy9wbGFjZU9yZGVy"/&gt;
                    &lt;L7p:VariableToSet stringValue="soapAction"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="http://ssg:8080/ACMEWarehouse/services/WarehouseSoap"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Cookie"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:CustomizeValue stringValue="&amp;quot;${soapAction}&amp;quot;"/&gt;
                                &lt;L7p:Name stringValue="SOAPAction"/&gt;
                                &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="soapContent"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:ForwardAll booleanValue="true"/&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                        &lt;L7p:Rules httpPassthroughRules="included"&gt;
                            &lt;L7p:item httpPassthroughRule="included"&gt;
                                &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                        &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:output indent="yes" method="xml" /&gt;
  &lt;xsl:strip-space elements="*" /&gt;
  &lt;xsl:template match="*[(local-name()='Envelope' or local-name()='Body') and (namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/' or namespace-uri()='http://www.w3.org/2003/05/soap-envelope')]"&gt;
    &lt;xsl:apply-templates select="@*|node()" /&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="*"&gt;
    &lt;xsl:element name="{local-name()}"&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:element&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="@*|node()" priority="-2"&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select="@*|node()" /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;L7p:XsltVersion stringValue="1.0"/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget="included"&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                        &lt;L7p:Target target="OTHER"/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue="true"/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="response"/&gt;
                    &lt;L7p:RootTagString stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Transforming the /placeOrder operation"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValue="{&amp;quot;error&amp;quot;:&amp;quot;invalid request&amp;quot;}"/&gt;
                    &lt;L7p:ContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"/&gt;
                &lt;/L7p:CustomizeErrorResponse&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Invalid request error if nothing suits above conditions"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
        </l7:ResourceSet>
    </l7:Resources>
</l7:Service>
